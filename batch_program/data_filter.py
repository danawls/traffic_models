# 데이터 프라이머리 키 설정 및 통합 전 준비
import dask.dataframe as ddf
import pandas as pd

columns_each = {'소통':['생성일', '생성시분', '링크ID', '통행속도', '통행시간'],
                '돌발':['돌발일시', '관리기관', '도로타입', '도로번호', '도로명', '방향', '돌발구분', '돌발상세구분', '돌발내용',
                      'X', 'Y', '링크아이디', '돌발종료일시'],
                '기상':['지점', '지점명', '일시', '기온(°C)', '풍향(deg)', '풍속(m/s)', '강수량(mm)',
                      '현지기압(hPa)', '해면기압(hPa)', '습도(%)'],
                '도로':['PRESENT_SN', 'LCLAS_CL', 'ATRB_SE', 'WTNNC_SN', 'NTFC_SN', 'DGM_NM',
                      'DGM_AR', 'DGM_LT', 'SIGNGU_SE', 'GRAD_SE', 'ROAD_TY', 'ROAD_NO',
                      'ROAD_ROLE', 'EXCUT_SE', 'geometry'],
                '지역':['사고지역관리번호', '사고연도', '사고유형구분', '위치코드', '사고다발지역시도시군구', '사고지역위치명', '사고건수',
                      '사상자수', '사망자수', '중상자수', '경상자수', '부상신고자수', '위도', '경도', '사고다발지역폴리곤정보',
                      '데이터기준일자', '제공기관코드', '제공기관명'],
                '카메라':['무인교통단속카메라관리번호', '시도명', '시군구명', '도로종류', '도로노선명', '도로노선방향', '소재지지번주소',
                       '위도', '경도', '설치장소', '단속구분', '제한속도', '보호구역구분', '관리기관명', '관리기관전화번호',
                       '데이터기준일자', '제공기관코드', '제공기관명'],
                '노드':['NODE_ID', 'NODE_TYPE', 'NODE_NAME', 'TURN_P', 'UPDATEDATE',
                      'geometry'],
                '링크':['LINK_ID', 'F_NODE', 'T_NODE', 'LANES', 'ROAD_RANK', 'ROAD_TYPE',
                      'ROAD_NO', 'ROAD_NAME', 'ROAD_USE', 'MULTI_LINK', 'CONNECT', 'MAX_SPD',
                      'REST_VEH', 'REST_W', 'REST_H', 'C-ITS', 'LENGTH', 'UPDATEDATE',
                      'geometry'],
                '인구':['행정기관코드',
                      '기준연월',
                      '시도명',
                      '시군구명',
                      '읍면동명',
                      '계',
                      '남자',
                      '여자',
                      '0세남자',
                      '1세남자',
                      '2세남자',
                      '3세남자',
                      '4세남자',
                      '5세남자',
                      '6세남자',
                      '7세남자',
                      '8세남자',
                      '9세남자',
                      '10세남자',
                      '11세남자',
                      '12세남자',
                      '13세남자',
                      '14세남자',
                      '15세남자',
                      '16세남자',
                      '17세남자',
                      '18세남자',
                      '19세남자',
                      '20세남자',
                      '21세남자',
                      '22세남자',
                      '23세남자',
                      '24세남자',
                      '25세남자',
                      '26세남자',
                      '27세남자',
                      '28세남자',
                      '29세남자',
                      '30세남자',
                      '31세남자',
                      '32세남자',
                      '33세남자',
                      '34세남자',
                      '35세남자',
                      '36세남자',
                      '37세남자',
                      '38세남자',
                      '39세남자',
                      '40세남자',
                      '41세남자',
                      '42세남자',
                      '43세남자',
                      '44세남자',
                      '45세남자',
                      '46세남자',
                      '47세남자',
                      '48세남자',
                      '49세남자',
                      '50세남자',
                      '51세남자',
                      '52세남자',
                      '53세남자',
                      '54세남자',
                      '55세남자',
                      '56세남자',
                      '57세남자',
                      '58세남자',
                      '59세남자',
                      '60세남자',
                      '61세남자',
                      '62세남자',
                      '63세남자',
                      '64세남자',
                      '65세남자',
                      '66세남자',
                      '67세남자',
                      '68세남자',
                      '69세남자',
                      '70세남자',
                      '71세남자',
                      '72세남자',
                      '73세남자',
                      '74세남자',
                      '75세남자',
                      '76세남자',
                      '77세남자',
                      '78세남자',
                      '79세남자',
                      '80세남자',
                      '81세남자',
                      '82세남자',
                      '83세남자',
                      '84세남자',
                      '85세남자',
                      '86세남자',
                      '87세남자',
                      '88세남자',
                      '89세남자',
                      '90세남자',
                      '91세남자',
                      '92세남자',
                      '93세남자',
                      '94세남자',
                      '95세남자',
                      '96세남자',
                      '97세남자',
                      '98세남자',
                      '99세남자',
                      '100세남자',
                      '101세남자',
                      '102세남자',
                      '103세남자',
                      '104세남자',
                      '105세남자',
                      '106세남자',
                      '107세남자',
                      '108세남자',
                      '109세남자',
                      '110세이상 남자',
                      '0세여자',
                      '1세여자',
                      '2세여자',
                      '3세여자',
                      '4세여자',
                      '5세여자',
                      '6세여자',
                      '7세여자',
                      '8세여자',
                      '9세여자',
                      '10세여자',
                      '11세여자',
                      '12세여자',
                      '13세여자',
                      '14세여자',
                      '15세여자',
                      '16세여자',
                      '17세여자',
                      '18세여자',
                      '19세여자',
                      '20세여자',
                      '21세여자',
                      '22세여자',
                      '23세여자',
                      '24세여자',
                      '25세여자',
                      '26세여자',
                      '27세여자',
                      '28세여자',
                      '29세여자',
                      '30세여자',
                      '31세여자',
                      '32세여자',
                      '33세여자',
                      '34세여자',
                      '35세여자',
                      '36세여자',
                      '37세여자',
                      '38세여자',
                      '39세여자',
                      '40세여자',
                      '41세여자',
                      '42세여자',
                      '43세여자',
                      '44세여자',
                      '45세여자',
                      '46세여자',
                      '47세여자',
                      '48세여자',
                      '49세여자',
                      '50세여자',
                      '51세여자',
                      '52세여자',
                      '53세여자',
                      '54세여자',
                      '55세여자',
                      '56세여자',
                      '57세여자',
                      '58세여자',
                      '59세여자',
                      '60세여자',
                      '61세여자',
                      '62세여자',
                      '63세여자',
                      '64세여자',
                      '65세여자',
                      '66세여자',
                      '67세여자',
                      '68세여자',
                      '69세여자',
                      '70세여자',
                      '71세여자',
                      '72세여자',
                      '73세여자',
                      '74세여자',
                      '75세여자',
                      '76세여자',
                      '77세여자',
                      '78세여자',
                      '79세여자',
                      '80세여자',
                      '81세여자',
                      '82세여자',
                      '83세여자',
                      '84세여자',
                      '85세여자',
                      '86세여자',
                      '87세여자',
                      '88세여자',
                      '89세여자',
                      '90세여자',
                      '91세여자',
                      '92세여자',
                      '93세여자',
                      '94세여자',
                      '95세여자',
                      '96세여자',
                      '97세여자',
                      '98세여자',
                      '99세여자',
                      '100세여자',
                      '101세여자',
                      '102세여자',
                      '103세여자',
                      '104세여자',
                      '105세여자',
                      '106세여자',
                      '107세여자',
                      '108세여자',
                      '109세여자',
                      '110세이상 여자'],
                '혼잡빈도':['집계년월', '집계시분', 'VDS_ID', '기점종점방향구분코드', '노선번호', '지점이정', '도로이정', '평균교통량',
                        '평균속도', '혼잡빈도수', '차로번호', '콘존명', '콘존길이']}

class Data_filter():
    def __init__(self, origin_data, count):
        self.origin_data = origin_data
        self.count = count

    def controller(self):
        #데이터 수정 진행
        print('다발지역 설정 시작')
        self.area_edit()
        print('링크 설정 시작')
        self.link_edit()
        print('노드 설정 시작')
        self.node_edit()
        print('카메라 설정 시작')
        self.cam_edit()
        print('혼잡빈도 설정 시작')
        self.confusion_edit()
        print('돌발 데이터 설정 시작')
        self.its_e_edit()
        print('기상 데이터 설정 시작')
        self.weather_edit()
        print('인구 데이터 설정 시작')
        self.people_edit()
        print('지점 데이터 설정 시작')
        self.spot_edit()
        # 임시로
        return self.origin_data

    def its_e_edit(self):
        for i in range(4):
            tm = 1 + 3 * i
            e_data = self.origin_data[f'{tm}월'][1]
            for v in range(self.count):
                e_data[v] = e_data[v].drop(['관리기관', 'X', 'Y', '돌발종료일시'], axis=1)
                print(e_data[v])


    def weather_edit(self):
        for i in range(4):
            tm = 1 + 3 * i
            w_data = self.origin_data[f'{tm}월'][2]
            w_data = w_data.drop(['지점명'], axis=1)
            self.origin_data[f'{tm}월'][2] = w_data


    def area_edit(self):
        area_data = self.origin_data['다발지역']
        area_data = area_data.drop(['사고지역관리번호', '사고연도', '위치코드', '사고다발지역시도시군구', '사고지역위치명', '사망자수', '중상자수', '경상자수', '사고다발지역폴리곤정보',
       '데이터기준일자', '제공기관코드', '제공기관명'], axis=1)
        self.origin_data['다발지역'] = area_data


    def cam_edit(self):
        cam_data = self.origin_data['카메라']
        cam_data = cam_data.drop(['무인교통단속카메라관리번호', '시도명', '시군구명', '소재지지번주소', '관리기관명', '관리기관전화번호', '데이터기준일자', '제공기관코드', '제공기관명'], axis=1)
        self.origin_data['카메라'] = cam_data

    def node_edit(self):
        node_data = self.origin_data['노드']
        node_data = node_data.drop(['NODE_NAME', 'UPDATEDATE'], axis=1)
        self.origin_data['노드'] = node_data

    def link_edit(self):
        link_data = self.origin_data['링크']
        link_data = link_data.drop(['ROAD_NAME', 'REST_VEH', 'REST_W', 'REST_H', 'C-ITS', 'UPDATEDATE', 'geometry'], axis=1)
        self.origin_data['링크'] = link_data

    def people_edit(self):
        people_data = self.origin_data['인구']
        people_data = people_data.drop(['행정기관코드',
                      '기준연월',
                      '0세남자',
                      '1세남자',
                      '2세남자',
                      '3세남자',
                      '4세남자',
                      '5세남자',
                      '6세남자',
                      '7세남자',
                      '8세남자',
                      '9세남자',
                      '10세남자',
                      '11세남자',
                      '12세남자',
                      '13세남자',
                      '14세남자',
                      '15세남자',
                      '16세남자',
                      '17세남자',
                      '18세남자',
                      '19세남자',
                      '20세남자',
                      '21세남자',
                      '22세남자',
                      '23세남자',
                      '24세남자',
                      '25세남자',
                      '26세남자',
                      '27세남자',
                      '28세남자',
                      '29세남자',
                      '30세남자',
                      '31세남자',
                      '32세남자',
                      '33세남자',
                      '34세남자',
                      '35세남자',
                      '36세남자',
                      '37세남자',
                      '38세남자',
                      '39세남자',
                      '40세남자',
                      '41세남자',
                      '42세남자',
                      '43세남자',
                      '44세남자',
                      '45세남자',
                      '46세남자',
                      '47세남자',
                      '48세남자',
                      '49세남자',
                      '50세남자',
                      '51세남자',
                      '52세남자',
                      '53세남자',
                      '54세남자',
                      '55세남자',
                      '56세남자',
                      '57세남자',
                      '58세남자',
                      '59세남자',
                      '60세남자',
                      '61세남자',
                      '62세남자',
                      '63세남자',
                      '64세남자',
                      '65세남자',
                      '66세남자',
                      '67세남자',
                      '68세남자',
                      '69세남자',
                      '70세남자',
                      '71세남자',
                      '72세남자',
                      '73세남자',
                      '74세남자',
                      '75세남자',
                      '76세남자',
                      '77세남자',
                      '78세남자',
                      '79세남자',
                      '80세남자',
                      '81세남자',
                      '82세남자',
                      '83세남자',
                      '84세남자',
                      '85세남자',
                      '86세남자',
                      '87세남자',
                      '88세남자',
                      '89세남자',
                      '90세남자',
                      '91세남자',
                      '92세남자',
                      '93세남자',
                      '94세남자',
                      '95세남자',
                      '96세남자',
                      '97세남자',
                      '98세남자',
                      '99세남자',
                      '100세남자',
                      '101세남자',
                      '102세남자',
                      '103세남자',
                      '104세남자',
                      '105세남자',
                      '106세남자',
                      '107세남자',
                      '108세남자',
                      '109세남자',
                      '110세이상 남자',
                      '0세여자',
                      '1세여자',
                      '2세여자',
                      '3세여자',
                      '4세여자',
                      '5세여자',
                      '6세여자',
                      '7세여자',
                      '8세여자',
                      '9세여자',
                      '10세여자',
                      '11세여자',
                      '12세여자',
                      '13세여자',
                      '14세여자',
                      '15세여자',
                      '16세여자',
                      '17세여자',
                      '18세여자',
                      '19세여자',
                      '20세여자',
                      '21세여자',
                      '22세여자',
                      '23세여자',
                      '24세여자',
                      '25세여자',
                      '26세여자',
                      '27세여자',
                      '28세여자',
                      '29세여자',
                      '30세여자',
                      '31세여자',
                      '32세여자',
                      '33세여자',
                      '34세여자',
                      '35세여자',
                      '36세여자',
                      '37세여자',
                      '38세여자',
                      '39세여자',
                      '40세여자',
                      '41세여자',
                      '42세여자',
                      '43세여자',
                      '44세여자',
                      '45세여자',
                      '46세여자',
                      '47세여자',
                      '48세여자',
                      '49세여자',
                      '50세여자',
                      '51세여자',
                      '52세여자',
                      '53세여자',
                      '54세여자',
                      '55세여자',
                      '56세여자',
                      '57세여자',
                      '58세여자',
                      '59세여자',
                      '60세여자',
                      '61세여자',
                      '62세여자',
                      '63세여자',
                      '64세여자',
                      '65세여자',
                      '66세여자',
                      '67세여자',
                      '68세여자',
                      '69세여자',
                      '70세여자',
                      '71세여자',
                      '72세여자',
                      '73세여자',
                      '74세여자',
                      '75세여자',
                      '76세여자',
                      '77세여자',
                      '78세여자',
                      '79세여자',
                      '80세여자',
                      '81세여자',
                      '82세여자',
                      '83세여자',
                      '84세여자',
                      '85세여자',
                      '86세여자',
                      '87세여자',
                      '88세여자',
                      '89세여자',
                      '90세여자',
                      '91세여자',
                      '92세여자',
                      '93세여자',
                      '94세여자',
                      '95세여자',
                      '96세여자',
                      '97세여자',
                      '98세여자',
                      '99세여자',
                      '100세여자',
                      '101세여자',
                      '102세여자',
                      '103세여자',
                      '104세여자',
                      '105세여자',
                      '106세여자',
                      '107세여자',
                      '108세여자',
                      '109세여자',
                      '110세이상 여자'], axis=1)
        self.origin_data['인구'] = people_data

    def confusion_edit(self):
        for i in range(4):
            tm = 1 + 3 * i
            c_data = self.origin_data[f'{tm}월'][3]
            c_data = c_data.drop(['VDS_ID', '기점종점방향구분코드'], axis=1)
            self.origin_data[f'{tm}월'][3] = c_data

    def spot_edit(self):
        spot_data = self.origin_data['지점']
        spot_data = spot_data.drop(['지점명'], axis=1)
        self.origin_data['지점'] = spot_data